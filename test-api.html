// Test Google Sheets API connection
async function testGoogleSheetsAPI() {
  console.log('üß™ Testing Google Sheets API...');
  
  try {
    // Import the service dynamically
    const { GoogleSheetsService } = await import('./src/services/api/googleSheetsService.ts');
    
    // Test 1: Check access token
    console.log('\n1Ô∏è‚É£ Testing access token...');
    const accessToken = await GoogleSheetsService.getAccessToken();
    
    if (!accessToken) {
      console.error('‚ùå No access token available');
      return;
    }
    
    console.log('‚úÖ Access token found:', accessToken.substring(0, 20) + '...');
    
    // Test 2: Test connection
    console.log('\n2Ô∏è‚É£ Testing API connection...');
    const isConnected = await GoogleSheetsService.testConnection();
    
    if (!isConnected) {
      console.error('‚ùå API connection failed');
      return;
    }
    
    console.log('‚úÖ API connection successful');
    
    // Test 3: Fetch accounts
    console.log('\n3Ô∏è‚É£ Fetching Google Sheets accounts...');
    const accounts = await GoogleSheetsService.getSheetsAccounts();
    
    console.log(`‚úÖ Found ${accounts.length} account(s)`);
    
    accounts.forEach((account, i) => {
      console.log(`\n   Account ${i + 1}: ${account.name} (${account.email})`);
      console.log(`   Spreadsheets: ${account.sheets.length}`);
      
      account.sheets.forEach((sheet, j) => {
        console.log(`     ${j + 1}. ${sheet.name}`);
        console.log(`        ID: ${sheet.id}`);
        console.log(`        Sheets: ${sheet.sheets?.join(', ') || 'Unknown'}`);
      });
    });
    
    if (accounts.length === 0) {
      console.log('\n‚ö†Ô∏è  No spreadsheets found');
      console.log('üí° Make sure you have Google Sheets in your Drive');
    }
    
    console.log('\nüéâ Test completed successfully!');
    
  } catch (error) {
    console.error('\n‚ùå Test failed:', error);
    console.error('Stack:', error.stack);
  }
}

// Run the test
testGoogleSheetsAPI();
